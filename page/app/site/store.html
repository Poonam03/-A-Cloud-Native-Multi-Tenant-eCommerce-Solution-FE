<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="multikart">
    <meta name="keywords" content="multikart">
    <meta name="author" content="multikart">
    <link rel="icon" href="../assets/images/favicon/25.png" type="image/x-icon">
    <link rel="shortcut icon" href="../assets/images/favicon/25.png" type="image/x-icon">
    <title>Multikart - Multi-purpose E-commerce Html Template</title>

    <!--Google font-->
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Yellowtail&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/font-awesome.css">

    <!--Slick slider css-->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/slick.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/slick-theme.css">

    <!-- Animate icon -->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/animate.css">

    <!-- Themify icon -->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/themify-icons.css">

    <!-- Bootstrap css -->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/bootstrap.css">

    <!-- Theme css -->
    <link rel="stylesheet" type="text/css" href="../assets/css/style.css">

</head>

<body class="theme-color-29">

    <!-- header start -->
    <header class="header-tools zindex-up header-style top-relative">
        <div class="mobile-fix-option"></div>
        <div class="logo-menu-part">
            <div class="container container-lg border-bottom-0 rounded-5">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="main-menu">
                            <div class="menu-left">
                                <div class="brand-logo">
                                    <a href="index.html"> <img src="../assets/images/icon/logo/36.png"
                                            class="img-fluid blur-up lazyload" alt=""></a>
                                </div>
                            </div>
                            <div class="menu-right pull-right">
                                <div>
                                    <nav id="main-nav">
                                        <div class="toggle-nav"><i class="fa fa-bars sidebar-bar"></i></div>
                                        <ul id="main-menu" class="sm pixelstrap sm-horizontal">
                                            <li>
                                                <div class="mobile-back text-end">Back<i class="fa fa-angle-right ps-2"
                                                        aria-hidden="true"></i></div>
                                            </li>
                                            <li><a href="index.html">Home</a></li>
                                            <li><a href="cehckout.html">Checkout</a></li>
                                            <li id="user"></li>
                                        </ul>
                                    </nav>
                                </div>
                                <div class="top-header">
                                    <ul class="header-dropdown">
                                        <li class="onhover-dropdown mobile-account">
                                            <img src="../assets/images/icon/user-1.png" alt="">
                                            <span id = "login" style="color:black"></span>
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <div class="icon-nav">
                                        <ul>
                                            <li class="onhover-div mobile-setting">
                                                <div><img src="../assets/images/icon/setting-1.png"
                                                        class="img-fluid blur-up lazyload" alt="">
                                                    <i class="ti-settings"></i>
                                                </div>
                                                <div class="show-div setting">
                                                    <h6>language</h6>
                                                    <ul>
                                                        <li><a href="#">english</a> </li>
                                                    </ul>

                                                </div>
                                            </li>
                                            <li class="onhover-div mobile-cart">
                                                <a href="cart.html">
                                                    <div><img src="../assets/images/icon/cart-1.png"
                                                              class="img-fluid blur-up lazyload" alt="">
                                                        <i class="ti-shopping-cart"></i>
                                                    </div>
                                                </a>

                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- header end -->





    <!-- category section start -->
    <section class="bg-light section-b-space">
        <div class="container-lg container">
            <div class="row">
                <div class="col-12">
                    <div class="title1 title-fancy">
                        <h4>Category</h4>
                        <h2 class="title-inner1 title-gradient">All Category</h2>
                    </div>
                </div>
            </div>
            <div class="row margin-default ratio_square " id="add-category">

            </div>
        </div>
    </section>
    <!-- category section end -->


    <!-- product slider -->
    <section class="ratio_asos gradient-slider" id = "product-slider">
        <div class="container container-lg">
            <div class="row">
                <div class="col-12">
                    <div class="title1 title-fancy">
                        <h4>All products</h4>
                        <h2 class="title-inner1 title-gradient">All products</h2>
                    </div>
                </div>
                <div class="col">
                    <div class="product-5 product-m no-arrow" id="product-add">
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- product slider -->




    <!-- footer -->
    <footer class="footer-light">
        <div class="light-layout">
            <div class="container container-lg">
                <section class="small-section border-section border-top-0">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="subscribe">
                                <div>
                                    <h4>KNOW IT ALL FIRST!</h4>
                                    <p>Never Miss Anything From Multikart By Signing Up To Our Newsletter.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <form
                                action="https://pixelstrap.us19.list-manage.com/subscribe/post?u=5a128856334b598b395f1fc9b&amp;id=082f74cbda"
                                class="form-inline subscribe-form auth-form needs-validation" method="post"
                                id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank">
                                <div class="form-group mx-sm-3">
                                    <input type="text" class="form-control" name="EMAIL" id="mce-EMAIL"
                                        placeholder="Enter your email" required="required">
                                </div>
                                <button type="submit" class="btn btn-solid btn-gradient"
                                    id="mc-submit">subscribe</button>
                            </form>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <div class="sub-footer">
            <div class="container container-lg">
                <div class="row">
                    <div class="col-xl-6 col-md-6 col-sm-12">
                        <div class="footer-end">
                            <p><i class="fa fa-copyright" aria-hidden="true"></i> E-Commerce Website</p>
                        </div>
                    </div>
                    <div class="col-xl-6 col-md-6 col-sm-12">
                        <div class="payment-card-bottom">
                            <ul>
                                <li>
                                    <a href="#"><img src="../assets/images/icon/visa.png" alt=""></a>
                                </li>
                                <li>
                                    <a href="#"><img src="../assets/images/icon/mastercard.png" alt=""></a>
                                </li>
                                <li>
                                    <a href="#"><img src="../assets/images/icon/paypal.png" alt=""></a>
                                </li>
                                <li>
                                    <a href="#"><img src="../assets/images/icon/american-express.png" alt=""></a>
                                </li>
                                <li>
                                    <a href="#"><img src="../assets/images/icon/discover.png" alt=""></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- footer end -->


    <!-- subscribe start -->
    <div class="cookie-bar left-bottom subscribe-box">
        <h2>hey you !!</h2>
        <p>Join our subscribers list to get the latest updates and special offers delivered directly in your inbox</p>
        <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="Enter your Email" aria-label="Recipient's username"
                aria-describedby="button-addon2">
            <button class="btn btn-solid btn-sm btn-gradient" type="button" id="button-addon2">subscribe</button>
        </div>
        <a href="javascript:void(0)" class="btn-close"><i class="fa fa-times" aria-hidden="true"></i></a>
    </div>



    <!-- tap to top start -->
    <div class="tap-top gradient-top">
        <div><i class="fa fa-angle-double-up"></i></div>
    </div>
    <!-- tap to top end -->


    <!-- latest jquery-->
    <script src="../assets/js/jquery-3.3.1.min.js"></script>

    <!-- slick js-->
    <script src="../assets/js/slick.js"></script>
    <script src="../assets/js/slick-animation.min.js"></script>

    <!-- wow js-->
    <script src="../assets/js/wow.min.js"></script>

    <!-- menu js-->
    <script src="../assets/js/menu.js"></script>

    <!-- lazyload js-->
    <script src="../assets/js/lazysizes.min.js"></script>

    <!-- Bootstrap js-->
    <script src="../assets/js/bootstrap.bundle.min.js"></script>

    <!-- Bootstrap Notification js-->
    <script src="../assets/js/bootstrap-notify.min.js"></script>

    <!-- Theme js-->
    <script src="../assets/js/theme-setting.js"></script>
    <script src="../assets/js/color-setting.js"></script>
    <script src="../assets/js/script.js"></script>
    <script src="../assets/js/custom-slick-animated.js"></script>

    <script>
        new WOW().init();

        function openSearch() {
            document.getElementById("search-overlay").style.display = "block";
        }

        function closeSearch() {
            document.getElementById("search-overlay").style.display = "none";
        }

        const requestOptions = {
            method: "GET",
            redirect: "follow"
        };

        const storeName = window.location.hash;

        if(storeName === undefined || window.localStorage.getItem('store') === undefined){
            window.localStorage.removeItem('store');
            window.location.href = 'index.html';
        } else{
            fetch(`http://localhost:8080/mt/v1/vendor/unsecured/${storeName.replace('#', '')}`, requestOptions)
                .then((response) => {
                    if(response.ok){

                        response.json()
                            .then((vendor) => {
                                window.localStorage.setItem('store', vendor.id)

                                const addCategory = document.getElementById('add-category');

                                const storeId = window.localStorage.getItem('store');

                                fetch(`http://localhost:8080/mt/v1/category/unsecured/all?vendorId=${storeId}`, requestOptions)
                                    .then((response) => {
                                        if(response.ok){
                                            response.json()
                                                .then((categories) => {
                                                    let innerHtml = ``;
                                                    if(categories.length === 0 ){
                                                        innerHtml = `<h2 style="text-align: center">No category Added by vendor.</h2>`;
                                                    }
                                                    categories.forEach((category) => {
                                                        innerHtml += `
                                    <div class="col-xl-2 col-sm-3 col-4">
                                                <a href="javascript:loadProduct('${category.id}')">
                                                    <div class="img-category hover-effect">
                                                        <div class="pattern-bg bg2">
                                                            <div class="img-sec">
                                                                ${category.imageBOS[0] === undefined ? ``:`<img class="img-fluid" src="http://localhost:8080/mt/v1/image/unsecured/display/${category.imageBOS[0].imageUrl}" alt="${category.imageBOS[0].altText}">`}
                                                            </div>
                                                        </div>
                                                        <h4>${category.name}</h4>
                                                    </div>
                                                </a>
                                            </div>
                                    `;
                                                    });
                                                    addCategory.innerHTML = innerHtml;
                                                });
                                        } else{
                                            window.alert('Not able to load category.')
                                        }
                                    })
                                    .catch(err => window.alert(err))
                            });


                    } else{
                        throw new Error(response.statusText);
                    }
                })
                .catch(err => {
                    window.localStorage.removeItem('store');
                    window.location.href = 'soon.html';
                });
        }

        function loadProduct(categoryId){

            const requestOptions = {
                method: "GET",
                redirect: "follow"
            };

            fetch(`http://localhost:8080/mt/v1/product/unsecured/category/all?vendorId=${window.localStorage.getItem('store')}&categoryId=${categoryId}`, requestOptions)
                .then((response) => {
                    let innerHtml = ``;
                    response.json()
                        .then((products) => {
                            if(products.length === 0 ){
                                innerHtml = `<h2 style="text-align: center">No Product Added by vendor.</h2>`;
                            }
                            products.forEach((product) => {
                                innerHtml += `<div class="product-box" style="width: 280px">
                            <div class="img-wrapper">
                                <img
                                        src="${product.imageBOS[0] === undefined ? `../assets/images/gradient/product/4.jpg`:`http://localhost:8080/mt/v1/image/unsecured/display/${product.imageBOS[0].imageUrl}`}"
                                        class="img-fluid blur-up lazyload bg-img" alt="">
                                <div class="cart-box cart-box-bottom">
                                    <button onclick="cartAdd('${product.id}', 'http://localhost:8080/mt/v1/image/unsecured/display/${product.imageBOS[0].imageUrl}' , '${product.name}', '${product.price}' )" title="Add to cart"><i
                                            class="ti-shopping-cart"></i></button>
                                </div>
                            </div>
                            <div class="product-detail">
                                <div class="detail-inline">
                                    <h6>${product.name}</h6>
                                    <h4>${product.price}</h4>
                                </div>
                            </div>
                        </div>`;
                            });
                            document.getElementById('product-add').innerHTML = innerHtml;
                        })
                })
                .catch(err => window.alert("Failed to load product, Try again later."));


        }


        const user = document.getElementById('user');
        user.innerHTML = `${window.localStorage.getItem('userName') ? ` <a href="javascript:logout()">Logout</a>`: `<a href="login.html">Login</a>`}`;

        const username = document.getElementById('login');
        username.innerText = `${window.localStorage.getItem('userName') ? `${window.localStorage.getItem('userName')}`: 'Guest'}`;

        function logout() {
            window.localStorage.removeItem('userName');
            window.location.href = 'login.html';
        }

        function cartAdd(productId , image, name, price) {
            let cart = window.localStorage.getItem('cart');
            if(cart === undefined || cart === null){
                cart = {};
            } else{
                cart = JSON.parse(cart);
            }
            if(cart[productId] === undefined){
                cart[productId] = {quantity: 1, image: image, name: name, price: price};
            } else{
                let val = cart[productId]['quantity']+1;
                cart[productId] = {quantity: val, image: image, name: name, price: price};
            }
            window.localStorage.setItem('cart', JSON.stringify(cart));
            window.alert('Product added to cart')
        }
    </script>
</body>

</html>